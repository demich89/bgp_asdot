<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>BGP ASN Converter</title>
<style>

/* ---------- THEME VARIABLES ---------- */
:root {
    --bg: #ffffff;
    --fg: #000000;
    --box: #f4f4f4;
}
.dark {
    --bg: #111111;
    --fg: #eeeeee;
    --box: #222222;
}

/* ---------- UI MAIN ---------- */
body {
    font-family: monospace;
    background: var(--bg);
    color: var(--fg);
    margin: 0;
    padding: 0;
}
#container {
    max-width: 600px;
    margin: auto;
    padding: 16px;
}

h3 {
    text-align: center;
    margin-bottom: 20px;
    font-size: 22px;
}

input[type="text"] {
    width: 100%;
    font-size: 20px;
    padding: 10px;
    margin-top: 6px;
    border-radius: 6px;
    border: 1px solid #444;
    background: var(--box);
    color: var(--fg);
}

button {
    width: 100%;
    padding: 12px;
    margin-top: 14px;
    font-size: 20px;
    border: none;
    border-radius: 6px;
    background: #2979ff;
    color: white;
    cursor: pointer;
}
button:hover {
    background: #1c54b2;
}

.result {
    margin-top: 14px;
    font-size: 20px;
}

#historyTitle {
    margin-top: 30px;
    font-size: 20px;
}
.historyItem {
    background: var(--box);
    padding: 10px;
    margin-top: 6px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 17px;
    border: 1px solid #333;
}
.historyItem:hover {
    background: #5555;
}

#clearHistory {
    margin-top: 12px;
    width: 100%;
    padding: 10px;
    font-size: 18px;
    border: none;
    border-radius: 6px;
    background: #444;
    color: #eee;
}
#clearHistory:hover {
    background: #666;
}

/* ---------- THEME BUTTON ---------- */
#theme-toggle {
    display: flex;
    justify-content: center;
    align-items: center;
    background: none;
    border: none;
    cursor: pointer;
    margin-bottom: 20px;
}

#moon, #sun {
    stroke: var(--fg);
}

#sun { display: none; }
</style>
</head>
<body>

<div id="container">

<!-- LIGHT/DARK TOGGLE -->
<div class="text-center">
    <button id="theme-toggle">
        <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path></svg>
        <svg id="sun"  xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
    </button>
</div>

<h3>BGP ASN Converter (ASDOT â‡† ASPLAIN)</h3>

<input id="asn" type="text" placeholder="Enter ASN (e.g. 1.10 or 65546)">
<button onclick="convert()">Convert</button>

<p class="result">ASDOT: <span id="outdot"></span></p>
<p class="result">ASPLAIN: <span id="outlong"></span></p>

<p id="historyTitle">History</p>
<div id="history"></div>
<button id="clearHistory" onclick="clearHistory()">Clear history</button>

</div>

<script>
function loadHistory() {
    let h = JSON.parse(localStorage.getItem("asn_history") || "[]");
    let div = document.getElementById("history");
    div.innerHTML = "";

    for (let item of h.slice().reverse()) {
        let el = document.createElement("div");
        el.className = "historyItem";
        el.textContent = `Input: ${item.input} | ASDOT: ${item.dot} | ASPLAIN: ${item.long}`;
        el.onclick = () => {
            document.getElementById("asn").value = item.input;
            convert();
        }
        div.appendChild(el);
    }
}

function saveHistory(input, dot, long) {
    let h = JSON.parse(localStorage.getItem("asn_history") || "[]");
    h.push({input, dot, long});
    if (h.length > 50) h.shift();
    localStorage.setItem("asn_history", JSON.stringify(h));
}

function convert() {
    const input = document.getElementById("asn").value.trim();
    const dot = document.getElementById("outdot");
    const long = document.getElementById("outlong");

    dot.textContent = "";
    long.textContent = "";
    if (!input) return;

    let dotVal;
    let longVal;

    if (input.includes(".")) {
        const [hi, lo] = input.split(".");
        const n = Number(hi) * 65536 + Number(lo);
        dotVal = input;
        longVal = n;
    } else {
        const n = Number(input);
        const hi = Math.floor(n / 65536);
        const lo = n % 65536;
        dotVal = hi + "." + lo;
        longVal = n;
    }

    dot.textContent = dotVal;
    long.textContent = longVal;

    saveHistory(input, dotVal, longVal);
    loadHistory();
}

function clearHistory() {
    localStorage.removeItem("asn_history");
    loadHistory();
}

// THEME SWITCH
const themeBtn = document.getElementById("theme-toggle");
const sun = document.getElementById("sun");
const moon = document.getElementById("moon");

function setTheme(mode) {
    if (mode === "dark") {
        document.body.classList.add("dark");
        moon.style.display = "none";
        sun.style.display = "block";
    } else {
        document.body.classList.remove("dark");
        moon.style.display = "block";
        sun.style.display = "none";
    }
    localStorage.setItem("asn_theme", mode);
}

themeBtn.onclick = () => {
    const newTheme = document.body.classList.contains("dark") ? "light" : "dark";
    setTheme(newTheme);
};

// load theme on startup
setTheme(localStorage.getItem("asn_theme") || "dark");

// load history at startup
loadHistory();
</script>

</body>
</html>